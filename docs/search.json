[
  {
    "objectID": "simulation.html",
    "href": "simulation.html",
    "title": "Wealth Distribution Simulation",
    "section": "",
    "text": "#| '!! shinylive warning !!': |\n#|   shinylive does not work in self-contained HTML documents.\n#|   Please set `embed-resources: false` in your metadata.\n#| standalone: true\n#| viewerHeight: 600\n\nfrom shiny import App, ui, render, reactive\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom io import BytesIO\nimport base64\n\napp_ui = ui.page_fluid(\n    ui.h2(\"Wealth Distribution Simulation\"),\n    ui.layout_sidebar(\n        ui.sidebar(\n            ui.input_slider(\"population\", \"Population Size\", min=10, max=100, value=20),\n            ui.input_slider(\"initial_units\", \"Initial Units per Person\", min=1, max=50, value=10),\n            ui.input_slider(\"days\", \"Days to Simulate\", min=100, max=5000, value=1000, step=100),\n            ui.input_slider(\"runs\", \"Number of Runs\", min=1, max=50, value=10),\n            ui.input_action_button(\"run_sim\", \"Run Simulation\", class_=\"btn-primary\"),\n        ),\n        ui.output_plot(\"gini_hist\"),\n        ui.output_text_verbatim(\"stats\"),\n    ),\n)\n\ndef server(input, output, session):\n    @reactive.calc\n    @reactive.event(input.run_sim)\n    def run_simulation():\n        pop_size = input.population()\n        initial = input.initial_units()\n        num_days = input.days()\n        num_runs = input.runs()\n\n        gini_values = []\n\n        for run in range(num_runs):\n            population = np.full(pop_size, initial, dtype=float)\n\n            for day in range(num_days):\n                i, j = np.random.choice(len(population), 2, replace=False)\n                if population[i] &gt; 0:\n                    amount = np.random.randint(1, int(population[i]) + 1)\n                    population[i] -= amount\n                    population[j] += amount\n\n            # Calculate Gini coefficient\n            gini = (np.sum(np.abs(np.subtract.outer(population, population))) /\n                    (2 * len(population) * np.mean(population)))\n            gini_values.append(gini)\n\n        return gini_values\n\n    @output\n    @render.plot\n    def gini_hist():\n        gini_values = run_simulation()\n        if gini_values is None:\n            return None\n\n        fig, ax = plt.subplots(figsize=(8, 5))\n        ax.hist(gini_values, bins=10, range=(0, 1), rwidth=0.8, color='steelblue', edgecolor='white')\n        ax.set_xlabel('Gini Coefficient')\n        ax.set_ylabel('Frequency')\n        ax.set_title('Distribution of Gini Coefficients')\n        ax.set_xlim(0, 1)\n        return fig\n\n    @output\n    @render.text\n    def stats():\n        gini_values = run_simulation()\n        if gini_values is None:\n            return \"Click 'Run Simulation' to start\"\n\n        return (f\"Mean Gini: {np.mean(gini_values):.3f}\\n\"\n                f\"Std Dev:   {np.std(gini_values):.3f}\\n\"\n                f\"Min:       {np.min(gini_values):.3f}\\n\"\n                f\"Max:       {np.max(gini_values):.3f}\")\n\napp = App(app_ui, server)"
  }
]